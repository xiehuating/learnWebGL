<!DOCTYPE html>
<!-- saved from url=(0029)http://www.hiwebgl.com/?p=312 -->
<html dir="ltr" lang="zh-CN"><script type="text/javascript">
    var spector;
    var captureOnLoad = false;
    var captureOffScreen = false;
    window.__SPECTOR_Canvases = [];

    (function() {
        var __SPECTOR_Origin_EXTENSION_GetContext = HTMLCanvasElement.prototype.getContext;
        HTMLCanvasElement.prototype.__SPECTOR_Origin_EXTENSION_GetContext = __SPECTOR_Origin_EXTENSION_GetContext;

        HTMLCanvasElement.prototype.getContext = function () {
            var context = null;
            if (!arguments.length) {
                return context;
            }

            if (arguments.length === 1) {
                context = this.__SPECTOR_Origin_EXTENSION_GetContext(arguments[0]);
                if (context === null) {
                    return context;
                }
            }
            else if (arguments.length === 2) {
                context = this.__SPECTOR_Origin_EXTENSION_GetContext(arguments[0], arguments[1]);
                if (context === null) {
                    return context;
                }
            }

            var contextNames = ["webgl", "experimental-webgl", "webgl2", "experimental-webgl2"];
            if (contextNames.indexOf(arguments[0]) !== -1) {
                context.canvas.setAttribute("__spector_context_type", arguments[0]);
                // Notify the page a canvas is available.
                var myEvent = new CustomEvent("SpectorWebGLCanvasAvailableEvent");
                document.dispatchEvent(myEvent);

                if (captureOffScreen) {
                    var found = false;
                    for (var i = 0; i < window.__SPECTOR_Canvases.length; i++) {
                        if (window.__SPECTOR_Canvases[i] === this) {
                            found = true;
                            break;
                        }
                    }
                    if (!found) {
                        window.__SPECTOR_Canvases.push(this);
                    }
                }

                if (captureOnLoad) {
                    // Ensures canvas is in the dom to capture the one we are currently tracking.
                    if (this.parentElement || false) {
                        spector.captureContext(context, 500, false);
                        captureOnLoad = false;
                    }
                }
            }

            return context;
        }
    })()</script><script>(function main() {
    // Create enabled event
    function fireEnabledEvent() {
        // If gli exists, then we are already present and shouldn't do anything
        if (!window.gli) {
            setTimeout(function () {
                var enabledEvent = document.createEvent("Event");
                enabledEvent.initEvent("WebGLEnabledEvent", true, true);
                document.dispatchEvent(enabledEvent);
            }, 0);
        } else {
            //console.log("WebGL Inspector already embedded on the page - disabling extension");
        }
    };

    // Grab the path root from the extension
    document.addEventListener("WebGLInspectorReadyEvent", function (e) {
        var pathElement = document.getElementById("__webglpathroot");
        if (window["gliloader"]) {
            gliloader.pathRoot = pathElement.innerText;
        } else {
            // TODO: more?
            window.gliCssUrl = pathElement.innerText + "gli.all.css";
        }
    }, false);

    // Rewrite getContext to snoop for webgl
    var originalGetContext = HTMLCanvasElement.prototype.getContext;
    if (!HTMLCanvasElement.prototype.getContextRaw) {
        HTMLCanvasElement.prototype.getContextRaw = originalGetContext;
    }
    HTMLCanvasElement.prototype.getContext = function () {
        var ignoreCanvas = this.internalInspectorSurface;
        if (ignoreCanvas) {
            return originalGetContext.apply(this, arguments);
        }

        var result = originalGetContext.apply(this, arguments);
        if (result == null) {
            return null;
        }

        var contextNames = ["moz-webgl", "webkit-3d", "experimental-webgl", "webgl", "3d"];
        var requestingWebGL = contextNames.indexOf(arguments[0]) != -1;
        if (requestingWebGL) {
            // Page is requesting a WebGL context!
            fireEnabledEvent(this);

            // If we are injected, inspect this context
            if (window.gli) {
                if (gli.host.inspectContext) {
                    // TODO: pull options from extension
                    result = gli.host.inspectContext(this, result);
                    // NOTE: execute in a timeout so that if the dom is not yet
                    // loaded this won't error out.
                    window.setTimeout(function() {
                        var hostUI = new gli.host.HostUI(result);
                        result.hostUI = hostUI; // just so we can access it later for debugging
                    }, 0);
                }
            }
        }

        return result;
    };
})();</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Lesson 9 优化代码结构实现多物体运动 | HiWebGL</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/style.css">
<!--[if IE]>
<link rel="stylesheet" type="text/css" media="all" href="http://www.hiwebgl.com/wp-content/themes/mnchrome/style-ie.css" />
<![endif]-->
<link rel="stylesheet" type="text/css" media="all" href="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/custom.css"><link rel="pingback" href="http://www.hiwebgl.com/xmlrpc.php">
<meta name="robots" content="index,follow">
<link rel="canonical" href="http://www.hiwebgl.com/?p=312">
<link rel="alternate" type="application/rss+xml" title="HiWebGL » Feed" href="http://www.hiwebgl.com/?feed=rss2">
<link rel="alternate" type="application/rss+xml" title="HiWebGL » 评论 Feed" href="http://www.hiwebgl.com/?feed=comments-rss2">
<link rel="alternate" type="application/rss+xml" title="HiWebGL » Lesson 9 优化代码结构实现多物体运动 评论 Feed" href="http://www.hiwebgl.com/?feed=rss2&amp;p=312">
<link rel="stylesheet" id="wm-css" href="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/style(1).css" type="text/css" media="all">
<link rel="stylesheet" id="toc-screen-css" href="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/screen.css" type="text/css" media="all">
<link rel="stylesheet" id="codebox-css" href="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/codebox.css" type="text/css" media="screen">
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/jquery.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/front.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/widget.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/comment-reply.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/codebox.js.下载"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.hiwebgl.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.hiwebgl.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Lesson 8 深度缓存、透明度和混合" href="http://www.hiwebgl.com/?p=294">
<link rel="next" title="Intel公布开源项目River Trail 为Javascript带来并行编程特性" href="http://www.hiwebgl.com/?p=319">
<meta name="generator" content="Monochrome 1.0">
<link rel="canonical" href="http://www.hiwebgl.com/?p=312">
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/jquery.min.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/hoverIntent.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/superfish.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/supersubs.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/jquery.accordion.js.下载"></script>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/dropdowns.js.下载"></script>
<style type="text/css" media="all">
/* <![CDATA[ */
@import url("http://www.hiwebgl.com/wp-content/plugins/wp-table-reloaded/css/plugin.css?ver=1.9.3");
@import url("http://www.hiwebgl.com/wp-content/plugins/wp-table-reloaded/css/datatables.css?ver=1.9.3");
/* ]]> */
</style></head>
<body class="single single-post postid-312 single-format-standard">
<div id="wrapper" class="hfeed">
	<div id="header">
    	<div id="masthead">
        	<div id="branding" role="banner">
            	<div id="site-logo">
                	<a href="http://www.hiwebgl.com/" title="HiWebGL" rel="home">
                    	                    <img src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/logo.png" align="logo">
                    					</a>
                </div>
                <div id="site-description">最好的HTML5 WebGL中文资讯站！</div>
                            </div><!-- #branding -->
            <div id="access" role="navigation">
            		<div class="menu">
		<ul class="sf-menu sf-js-enabled">
			<li>
            	<a href="http://www.hiwebgl.com/" title="HiWebGL" rel="home">
				<strong>首页</strong><span>Homepage</span>
			</a></li>
						<li>
				<a href="http://www.hiwebgl.com/?p=42">
				<strong>教程</strong><span>&nbsp;</span></a>
							</li>
						<li>
				<a href="http://www.hiwebgl.com/?cat=16">
				<strong>Demo</strong><span>&nbsp;</span></a>
							</li>
						<li>
				<a href="http://www.hiwebgl.com/ask">
				<strong>有问必答</strong><span>&nbsp;</span></a>
							</li>
						<li>
				<a href="http://hiwebgl.com/forum/">
				<strong>论坛</strong><span>&nbsp;</span></a>
							</li>
					</ul>
	</div>
            </div><!-- #access -->
        </div><!-- #masthead -->
    </div><!-- #header -->
    
    <div id="breadcrumbWrap"><div id="breadcrumb">
<span>You are here: </span><a href="http://www.hiwebgl.com/">Home</a> » <a href="http://www.hiwebgl.com/?cat=17" title="查看 WebGL教程 中的全部文章">WebGL教程</a> » Lesson 9 优化代码结构实现多物体运动</div></div>    
    <div id="main">
		<div id="container">
			<div id="content" role="main">


				<div id="post-312" class="post-312 post type-post status-publish format-standard hentry category-webgl">
					<h1 class="entry-title">Lesson 9 优化代码结构实现多物体运动</h1>

					<div class="entry-meta">
							<span class="meta-author">By admin</span>
    <span class="meta-date">On 2011 年 9 月 20 日</span>
    <span class="meta-comment">3 条评论</span>
						2,226 次浏览					</div><!-- .entry-meta -->

					<div class="entry-content">
                		<p><span style="color: #888888;"><em>HiWebGL译者声明：因为译者个人方便的原因，我们将原教程中的第三方图形库由glMatrix改为Oak3D实现，这不影响到Demo的最终效果和实现，也不影响到WebGL的讲解和学习。原教程正文中相应的代码和讲解也为做了相应修改！本教程由HiWebGL翻译整理，转载请注明出处！</em></span></p>
<p><span style="color: #888888;"><em>关于Oak3D：Oak3D是一套简单易用、性能优越的WebGL Javascript Library。您可以在他们的主页找到更多信息。Oak3D主页：<a href="http://www.oak3d.com/" target="_blank"><span style="color: #888888;">http://www.oak3d.com</span></a>&nbsp;</em></span></p>
<p>欢迎来到WebGL教程的第9课，这节课的内容是基于NeHe的OpenGL教程的<a href="http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=09" target="_blank">第9节</a>改编的。这节课中，我们将使用Javascript对象来实现3D场景中的多个独立的运动物体。我们还会涉及到如何更改加载纹理的颜色以及如何混合纹理。</p>
<p>下面的视频就是我们这节课将会完成的最终效果。</p>
<p><embed src="http://player.youku.com/player.php/sid/XMzA1ODYzMDY4/v.swf" quality="high" width="480" height="400" align="middle" allowscriptaccess="sameDomain" type="application/x-shockwave-flash"></p>
<p>点击<a href="http://www.hiwebgl.com/webgl_lessons/lesson09/index.html" target="_blank">这里</a>打开一个独立的WebGL页面，如果你的浏览器不支持WebGL，请点击<a href="http://www.hiwebgl.com/?p=52" target="_blank">这里</a>。你会看到大量的不同颜色的星星，不断盘旋。</p>
<p>你可以点击画布下方的复选框来开启或关闭“闪光”效果（我们一会就会讲解到）。你还可以使用方向键来使星星围绕着X轴运动，并使用Page Up键和Page Down键来进行缩放。</p>
<p>下面我们来看看它是怎么工作的……</p>
<p>惯例声明：本系列的教程是针对那些已经具备相应编程知识但没有实际3D图形经验的人的；目标是让学习者创建并运行代码，并且明白代码其中的含义，从而可以快速地创建自己的3D Web页面。如果你还没有阅读前一课，请先阅读前一课的内容吧。因为本课中我只会讲解那些与前一课中不同的新知识。</p>
<p>另外，我编写这套教程是因为我在独立学习WebGL，所以教程中可能（非常可能）会有错误，所以还请风险自担。尽管如此，我还是会不断的修正bug和改正其中的错误的，所以如果你发现了教程中的错误，请告诉我。</p>
<p>有两种方法可以获得上面实例的代码：在实例的独立页面中选择“查看源代码”；或者点击<a href="http://www.hiwebgl.com/webgl_lessons/lesson09/lesson09.zip" target="_blank">这里</a>下载我们为您准备好的压缩包。</p>
<p>要讲清楚这节课与上节课不同的地方，最好的办法就是从代码底部开始，从webGLStart函数开始，下面就是本节课中的webGLStart函数：</p>

<div class="wp_codebox"><table><tbody><tr id="p3121"><td class="line_numbers"><pre>391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
</pre></td><td class="code" id="p312code1"><pre class="javascript" style="font-family:monospace;">    <span style="color: #003366; font-weight: bold;">function</span> webGLStart<span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        <span style="color: #003366; font-weight: bold;">var</span> canvas <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">(</span><span style="color: #3366CC;">"lesson09-canvas"</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        initGL<span style="color: #009900;">(</span>canvas<span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        initShaders<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        initBuffers<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        initTexture<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        initWorldObjects<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        gl.<span style="color: #660066;">clearColor</span><span style="color: #009900;">(</span><span style="color: #CC0000;">0.0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0.0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0.0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1.0</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        document.<span style="color: #660066;">onkeydown</span> <span style="color: #339933;">=</span> handleKeyDown<span style="color: #339933;">;</span>
        document.<span style="color: #660066;">onkeyup</span> <span style="color: #339933;">=</span> handleKeyUp<span style="color: #339933;">;</span>
&nbsp;
        tick<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">}</span></pre></td></tr></tbody></table></div>

<p>发生变化的代码位于第397行。我们新调用了一个initWorldObjects函数。这个函数创建了Javascript对象，我们很快就要讲到。但这之前我们还需要说一下一个非常细微的变化，那就是之前我们的webGLStart函数中都有下面一行代码来开启深度检测：</p>

<div class="wp_codebox"><table><tbody><tr id="p3122"><td class="line_numbers"><pre>1
</pre></td><td class="code" id="p312code2"><pre class="javascript" style="font-family:monospace;">    gl.<span style="color: #660066;">enable</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">DEPTH_TEST</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>但是在这一课的例子中我们移除了这行代码。你也许还记得，在上一课中，混合和深度检测这两位小朋友总是玩不到一起去。在这节课中我们将全时使用混合，而深度检测默认是关闭的，所以移除这行代码可以满足我们的需求。</p>
<p>下面一个重大的变化位于animate函数中。之前我们一直使用这个函数来更新全局变量以便实现场景中的动画效果——例如，在绘制立方体之前旋转角度的全局变量。这节课中我们还是要做类似的事情，但不是直接更新变量，而是遍历场景中的物体，让它们自己运动。</p>

<div class="wp_codebox"><table><tbody><tr id="p3123"><td class="line_numbers"><pre>368
369
370
371
372
373
374
375
376
377
378
379
</pre></td><td class="code" id="p312code3"><pre class="javascript" style="font-family:monospace;">    <span style="color: #003366; font-weight: bold;">function</span> animate<span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        <span style="color: #003366; font-weight: bold;">var</span> timeNow <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">new</span> Date<span style="color: #009900;">(</span><span style="color: #009900;">)</span>.<span style="color: #660066;">getTime</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">(</span>lastTime <span style="color: #339933;">!=</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
            <span style="color: #003366; font-weight: bold;">var</span> elapsed <span style="color: #339933;">=</span> timeNow <span style="color: #339933;">-</span> lastTime<span style="color: #339933;">;</span>
&nbsp;
            <span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">(</span><span style="color: #003366; font-weight: bold;">var</span> i <span style="color: #000066; font-weight: bold;">in</span> stars<span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
                stars<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span>.<span style="color: #660066;">animate</span><span style="color: #009900;">(</span>elapsed<span style="color: #009900;">)</span><span style="color: #339933;">;</span>
            <span style="color: #009900;">}</span>
        <span style="color: #009900;">}</span>
        lastTime <span style="color: #339933;">=</span> timeNow<span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #009900;">}</span></pre></td></tr></tbody></table></div>

<p>让我们继续，下面来看看drawScene函数。我不打算直接标出发生变化的所有代码，而是一点一点的来慢慢看。首先：</p>

<div class="wp_codebox"><table><tbody><tr id="p3124"><td class="line_numbers"><pre>345
346
347
348
349
</pre></td><td class="code" id="p312code4"><pre class="javascript" style="font-family:monospace;">    <span style="color: #003366; font-weight: bold;">function</span> drawScene<span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        gl.<span style="color: #660066;">viewport</span><span style="color: #009900;">(</span><span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> gl.<span style="color: #660066;">viewportWidth</span><span style="color: #339933;">,</span> gl.<span style="color: #660066;">viewportHeight</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        gl.<span style="color: #660066;">clear</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">COLOR_BUFFER_BIT</span> <span style="color: #339933;">|</span> gl.<span style="color: #660066;">DEPTH_BUFFER_BIT</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        pMatrix <span style="color: #339933;">=</span> okMat4Proj<span style="color: #009900;">(</span><span style="color: #CC0000;">45</span><span style="color: #339933;">,</span> gl.<span style="color: #660066;">viewportWidth</span> <span style="color: #339933;">/</span> gl.<span style="color: #660066;">viewportHeight</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0.1</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">100.0</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>以上是我们进行场景基本设置的代码，它从第一节课开始就没有变过。</p>

<div class="wp_codebox"><table><tbody><tr id="p3125"><td class="line_numbers"><pre>351
352
</pre></td><td class="code" id="p312code5"><pre class="javascript" style="font-family:monospace;">        gl.<span style="color: #660066;">blendFunc</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">SRC_ALPHA</span><span style="color: #339933;">,</span> gl.<span style="color: #660066;">ONE</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        gl.<span style="color: #660066;">enable</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">BLEND</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>接着，我们开启了混合。我们和上节课一样，使用同样的混合方法。你应该还记得，这项技术允许物体互相“透过”彼此。有用的是，这也就意味着，在绘制时，物体的黑色部分会被当成是透明的。如果想不明白其中的原理，请参考上一节课中我们对混合的讲解。也就是说，当我们绘制场景中的星星的时候，黑色的部分会看起来是透明的；进一步说，星星中不那么明亮的部分，看起来就会更透明一些。我们使用下面这个纹理来绘制星星</p>
<p><a href="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/star.gif"><img src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/star.gif" alt="" title="star" width="128" height="128" class="alignnone size-full wp-image-313"></a></p>
<p>这恰好给了我们想要的效果。</p>
<p>接下来的代码是：</p>

<div class="wp_codebox"><table><tbody><tr id="p3126"><td class="line_numbers"><pre>354
355
</pre></td><td class="code" id="p312code6"><pre class="javascript" style="font-family:monospace;">        mvMatrix <span style="color: #339933;">=</span> okMat4Trans<span style="color: #009900;">(</span><span style="color: #CC0000;">0.0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0.0</span><span style="color: #339933;">,</span> zoom<span style="color: #009900;">)</span><span style="color: #339933;">;</span> 
        mvMatrix.<span style="color: #660066;">rotX</span><span style="color: #009900;">(</span>OAK.<span style="color: #660066;">SPACE_LOCAL</span><span style="color: #339933;">,</span> tilt<span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>这里我们移动到了场景中央，并进行了合适的缩放。我们还让场景绕着X轴倾斜，在这里依然使用tilt这个全局变量来接收来自于键盘的输入，控制倾斜角度。好了，现在差不多就要开始绘制场景了。我们先检测一下“闪光”复选框是否被选中。</p>

<div class="wp_codebox"><table><tbody><tr id="p3127"><td class="line_numbers"><pre>357
</pre></td><td class="code" id="p312code7"><pre class="javascript" style="font-family:monospace;">        <span style="color: #003366; font-weight: bold;">var</span> twinkle <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">(</span><span style="color: #3366CC;">"twinkle"</span><span style="color: #009900;">)</span>.<span style="color: #660066;">checked</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>然后，就和我们刚才让星星自己运动一样，通过循环迭代来绘制每一颗星星。我们传入当前场景的倾斜角度（tilt）和闪光值（twinkle）。另外还有一个当前的“旋转（spin）”值，用于让星星在围绕场景中心公转的同时，还围绕自己的中心进行自转。</p>

<div class="wp_codebox"><table><tbody><tr id="p3128"><td class="line_numbers"><pre>358
359
360
361
362
363
</pre></td><td class="code" id="p312code8"><pre class="javascript" style="font-family:monospace;">        <span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">(</span><span style="color: #003366; font-weight: bold;">var</span> i <span style="color: #000066; font-weight: bold;">in</span> stars<span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
            stars<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span>.<span style="color: #660066;">draw</span><span style="color: #009900;">(</span>tilt<span style="color: #339933;">,</span> spin<span style="color: #339933;">,</span> twinkle<span style="color: #009900;">)</span><span style="color: #339933;">;</span>
            spin <span style="color: #339933;">+=</span> <span style="color: #CC0000;">0.1</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">}</span>
&nbsp;
    <span style="color: #009900;">}</span></pre></td></tr></tbody></table></div>

<p>好了，以上就是drawScene函数。我们可以清晰的看到，星星自主地被绘制出来和运动起来。接着往上看就是创建星星的代码：</p>

<div class="wp_codebox"><table><tbody><tr id="p3129"><td class="line_numbers"><pre>334
335
336
337
338
339
340
341
342
</pre></td><td class="code" id="p312code9"><pre class="javascript" style="font-family:monospace;">    <span style="color: #003366; font-weight: bold;">var</span> stars <span style="color: #339933;">=</span> <span style="color: #009900;">[</span><span style="color: #009900;">]</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #003366; font-weight: bold;">function</span> initWorldObjects<span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        <span style="color: #003366; font-weight: bold;">var</span> numStars <span style="color: #339933;">=</span> <span style="color: #CC0000;">50</span><span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #000066; font-weight: bold;">for</span> <span style="color: #009900;">(</span><span style="color: #003366; font-weight: bold;">var</span> i<span style="color: #339933;">=</span><span style="color: #CC0000;">0</span><span style="color: #339933;">;</span> i <span style="color: #339933;">&lt;</span> numStars<span style="color: #339933;">;</span> i<span style="color: #339933;">++</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
            stars.<span style="color: #660066;">push</span><span style="color: #009900;">(</span><span style="color: #003366; font-weight: bold;">new</span> Star<span style="color: #009900;">(</span><span style="color: #009900;">(</span>i <span style="color: #009966; font-style: italic;">/ numStars) * 5.0, i /</span> numStars<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">}</span>
    <span style="color: #009900;">}</span></pre></td></tr></tbody></table></div>

<p>通过一个简单的循环，我们创建了50颗星星（你也可以增加或减少星星的数量）。每颗星星被赋予的第一个参数用于指定距离场景中心的初始距离，第二个参数用于指定围绕场景中心公转的速度，这两个参数都是根据位置计算出来的。</p>
<p>下面，我们要看一看如何定义星星的类。如果你对Javascript并不熟悉，那这些代码看起来会有些奇怪。（如果你已经非常了解Javascript，那请略过这一部分关于建立对象模型的讲解吧！）</p>
<p>Javascript对象模型与其它语言有很大的不同。你可以将js对象理解为一个字典容器（哈希表，关联数组），对象成员作为数据放在对象容器中，由对象名称索引。所以，在Javascript中，当你像其它语言一样使用foo.bar形式调用成员时，实际上，你是在访问foo这个字典容器中的以bar为索引关键字的数据，即foo[“bar”]。</p>
<p>对于每个Javascript函数，都有一个特殊的私有变量“this”, 表示当前函数的“拥有者”。对于全局函数，this指向网页中的“windows”对象。如果你在引用this的前方加new关键字，那它的意义就不再是指向当前函数的拥有者，而是创建一个新的对象。所以，如果你有一个函数，在函数体内部将this.foo设置为1，this.bar设置为一个函数，并确保在调用此函数前使用new关键字， 那它的功能基本上等同于带class定义的类构造函数。</p>
<p>接下来，我们需要注意，如果一个函数在调用时指明了调用者（例如foo.bar()），那此函数在调用过程中就绑定在了它的调用者身上，正像大多数开发者希望的那样，通过这种方式我们可以让函数调用的内容只作用于它的调用者。</p>
<p>最后，对于每个函数，都有一个特殊的属性：prototype。prototype是一个字典容器，它内部存储了当使用new关键字创建此对象的副本时，所需要创建的成员变量。这是一种良好的定义Javascript“类”对象通用成员的方式——比如，类方法。</p>
<p>好了，让我们来看看定义Star对象的代码。</p>

<div class="wp_codebox"><table><tbody><tr id="p31210"><td class="line_numbers"><pre>265
266
267
268
269
270
271
272
</pre></td><td class="code" id="p312code10"><pre class="javascript" style="font-family:monospace;">    <span style="color: #003366; font-weight: bold;">function</span> Star<span style="color: #009900;">(</span>startingDistance<span style="color: #339933;">,</span> rotationSpeed<span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">angle</span> <span style="color: #339933;">=</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">dist</span> <span style="color: #339933;">=</span> startingDistance<span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">rotationSpeed</span> <span style="color: #339933;">=</span> rotationSpeed<span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #006600; font-style: italic;">// Set the colors to a starting value.</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">randomiseColors</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">}</span></pre></td></tr></tbody></table></div>

<p>在这个构造函数中，我们先初始化了星星，使其角度为0，然后又调用了一个方法。接下来我们要把几个方法绑定到Star函数相关的prototype上，让所有新创建的Star对象都有相同的方法。首先要绑定的方法是draw。</p>

<div class="wp_codebox"><table><tbody><tr id="p31211"><td class="line_numbers"><pre>274
275
</pre></td><td class="code" id="p312code11"><pre class="javascript" style="font-family:monospace;">    Star.<span style="color: #660066;">prototype</span>.<span style="color: #660066;">draw</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span> <span style="color: #009900;">(</span>tilt<span style="color: #339933;">,</span> spin<span style="color: #339933;">,</span> twinkle<span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        mvPushMatrix<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>draw方法被定义为将我们传入的参数带入到drawScene主函数中。我们一开始先把当前模型视图矩阵压入栈中，以此避免之前课程中提到过的副作用。</p>

<div class="wp_codebox"><table><tbody><tr id="p31212"><td class="line_numbers"><pre>277
278
279
</pre></td><td class="code" id="p312code12"><pre class="javascript" style="font-family:monospace;">        <span style="color: #006600; font-style: italic;">// Move to the star's position</span>
        mvMatrix.<span style="color: #660066;">rotY</span><span style="color: #009900;">(</span>OAK.<span style="color: #660066;">SPACE_LOCAL</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">angle</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        mvMatrix.<span style="color: #660066;">translate</span><span style="color: #009900;">(</span>OAK.<span style="color: #660066;">SPACE_LOCAL</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">dist</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0.0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0.0</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>然后，我们根据星星的角度值绕着Y轴旋转一下，然后根据星星的距离值移出场景中心。这让我们到达了绘制星星的正确位置。</p>

<div class="wp_codebox"><table><tbody><tr id="p31213"><td class="line_numbers"><pre>281
282
283
</pre></td><td class="code" id="p312code13"><pre class="javascript" style="font-family:monospace;">        <span style="color: #006600; font-style: italic;">// Rotate back so that the star is facing the viewer</span>
        mvMatrix.<span style="color: #660066;">rotY</span><span style="color: #009900;">(</span>OAK.<span style="color: #660066;">SPACE_LOCAL</span><span style="color: #339933;">,</span> <span style="color: #339933;">-</span><span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">angle</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>        
        mvMatrix.<span style="color: #660066;">rotX</span><span style="color: #009900;">(</span>OAK.<span style="color: #660066;">SPACE_LOCAL</span><span style="color: #339933;">,</span> <span style="color: #339933;">-</span>tilt<span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>这几行代码用于确保星星始终面对观察者，尤其是当接受键盘输入来控制场景的倾斜角度的时候。星星都是使用一个绘制在正方形中的2D纹理来贴图的，我们竖着看的时候是正常的；但是当场景倾斜的时候，那我们就只能看到它们的一侧了。所以，我们在放置星星的时候还需要还原这个旋转。当你做“逆旋转”的时候，你需要逆着一开始执行的顺序倒着回去。所以我们先还原了旋转，然后再做倾斜（这是在drawScene函数中完成的）。<br>
下面就要开始绘制星星了。</p>

<div class="wp_codebox"><table><tbody><tr id="p31214"><td class="line_numbers"><pre>285
286
287
288
289
290
291
292
293
294
295
296
</pre></td><td class="code" id="p312code14"><pre class="javascript" style="font-family:monospace;">        <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">(</span>twinkle<span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
            <span style="color: #006600; font-style: italic;">// Draw a non-rotating star in the alternate "twinkling" color</span>
            gl.<span style="color: #660066;">uniform3f</span><span style="color: #009900;">(</span>shaderProgram.<span style="color: #660066;">colorUniform</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">twinkleR</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">twinkleG</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">twinkleB</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
            drawStar<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">}</span>
&nbsp;
        <span style="color: #006600; font-style: italic;">// All stars spin around the Z axis at the same rate</span>
        mvMatrix.<span style="color: #660066;">rotZ</span><span style="color: #009900;">(</span>OAK.<span style="color: #660066;">SPACE_LOCAL</span><span style="color: #339933;">,</span> spin<span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #006600; font-style: italic;">// Draw the star in its main color</span>
        gl.<span style="color: #660066;">uniform3f</span><span style="color: #009900;">(</span>shaderProgram.<span style="color: #660066;">colorUniform</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">r</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">g</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">b</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        drawStar<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>让我们先忽略关于执行“闪光”效果的代码。星星先是根据传入的spin参数围绕Z轴进行自转。然后将星星的颜色通过uniform变量传送到显卡端，然后调用了一个全局函数drawStar（我们稍后讲解）。</p>
<p>现在来看看“闪光”的部分吧？好吧，每颗星星都有两个颜色，一个是正常的颜色，一个是闪光的颜色。在绘制闪光的星星前，我们先绘制了一个正常颜色下的星星。也就是说两个星星会混合在一起，实现了闪光；进一步说，第一次绘制的星星是不动的，而第二次绘制的星星是自转的，两者结合在一起，就给出了我们想要的闪光的效果。</p>
<p>好了，星星绘制完毕，我们要让模型视图矩阵出栈了。</p>

<div class="wp_codebox"><table><tbody><tr id="p31215"><td class="line_numbers"><pre>298
299
</pre></td><td class="code" id="p312code15"><pre class="javascript" style="font-family:monospace;">        mvPopMatrix<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">}</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>接下来我们要绑定到prototype上的方法是用来让星星运动的。</p>

<div class="wp_codebox"><table><tbody><tr id="p31216"><td class="line_numbers"><pre>302
303
</pre></td><td class="code" id="p312code16"><pre class="javascript" style="font-family:monospace;">    <span style="color: #003366; font-weight: bold;">var</span> effectiveFPMS <span style="color: #339933;">=</span> <span style="color: #CC0000;">60</span> <span style="color: #339933;">/</span> <span style="color: #CC0000;">1000</span><span style="color: #339933;">;</span>
    Star.<span style="color: #660066;">prototype</span>.<span style="color: #660066;">animate</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span> <span style="color: #009900;">(</span>elapsedTime<span style="color: #009900;">)</span> <span style="color: #009900;">{</span></pre></td></tr></tbody></table></div>

<p>在之前的课程中，与其让场景更快的更新状态，我选择了更稳健的方式，确保电脑较快的人能得到更平滑的动画效果，而电脑较慢的人也不至于那么糟糕。在本节课的示例中，我觉得让星星围绕场景中心公转、并最终收敛在场景中心的角度的变化速率是NeHe精心计算出来的，所以为了不把它搞乱套，我决定将每秒的帧率定在60fps，然后配合使用elapsedTime变量（你应该还记得，这个变量用来表示animate函数两次调用之间的时间间隔）来控制每次动画效果在“tick”函数中的运动的量。elapsedTime变量的单位是毫秒，所以每毫秒的帧率应当是60/1000。我们把它放到一个animate函数之外的全局变量中，从而保证我们每次绘制星星的时候它不会被重新计算。</p>
<p>现在我们可以根据这个数字调整星星的角度了，也就是星星在围绕场景中心的轨道上可以走多远。</p>

<div class="wp_codebox"><table><tbody><tr id="p31217"><td class="line_numbers"><pre>304
</pre></td><td class="code" id="p312code17"><pre class="javascript" style="font-family:monospace;">        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">angle</span> <span style="color: #339933;">+=</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">rotationSpeed</span> <span style="color: #339933;">*</span> effectiveFPMS <span style="color: #339933;">*</span> elapsedTime<span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>然后，我们可以调整星星到场景中心的距离，当星星最终到达场景中心的时候，将它移出场景之外，并且重置它的颜色。</p>

<div class="wp_codebox"><table><tbody><tr id="p31218"><td class="line_numbers"><pre>306
307
308
309
310
311
312
313
314
</pre></td><td class="code" id="p312code18"><pre class="javascript" style="font-family:monospace;">        <span style="color: #006600; font-style: italic;">// Decrease the distance, resetting the star to the outside of</span>
        <span style="color: #006600; font-style: italic;">// the spiral if it's at the center.</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">dist</span> <span style="color: #339933;">-=</span> <span style="color: #CC0000;">0.01</span> <span style="color: #339933;">*</span> effectiveFPMS <span style="color: #339933;">*</span> elapsedTime<span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">(</span><span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">dist</span> <span style="color: #339933;">&lt;</span> <span style="color: #CC0000;">0.0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
            <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">dist</span> <span style="color: #339933;">+=</span> <span style="color: #CC0000;">5.0</span><span style="color: #339933;">;</span>
            <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">randomiseColors</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">}</span>
&nbsp;
    <span style="color: #009900;">}</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>最后一段组成Star对象prototype的代码，是被构造函数调用，以及刚刚在动画中随机生成闪光和非闪光颜色的：</p>

<div class="wp_codebox"><table><tbody><tr id="p31219"><td class="line_numbers"><pre>317
318
319
320
321
322
323
324
325
326
327
328
329
330
</pre></td><td class="code" id="p312code19"><pre class="javascript" style="font-family:monospace;">    Star.<span style="color: #660066;">prototype</span>.<span style="color: #660066;">randomiseColors</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span> <span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        <span style="color: #006600; font-style: italic;">// Give the star a random color for normal</span>
        <span style="color: #006600; font-style: italic;">// circumstances...</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">r</span> <span style="color: #339933;">=</span> Math.<span style="color: #660066;">random</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">g</span> <span style="color: #339933;">=</span> Math.<span style="color: #660066;">random</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">b</span> <span style="color: #339933;">=</span> Math.<span style="color: #660066;">random</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #006600; font-style: italic;">// When the star is twinkling, we draw it twice, once</span>
        <span style="color: #006600; font-style: italic;">// in the color below (not spinning) and then once in the</span>
        <span style="color: #006600; font-style: italic;">// main color defined above.</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">twinkleR</span> <span style="color: #339933;">=</span> Math.<span style="color: #660066;">random</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">twinkleG</span> <span style="color: #339933;">=</span> Math.<span style="color: #660066;">random</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">twinkleB</span> <span style="color: #339933;">=</span> Math.<span style="color: #660066;">random</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">}</span><span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p>这样我们就完成了Star对象的prototype，其中我们建立了一个星星的对象，并且填充了方法来完成绘制和动画。现在，就在这些函数上面你可以看到绘制星星的代码（相当无趣）：用第一节课中我们熟知的方法绘制一个正方形，其中需要正确地使用纹理坐标数组、顶点位置数组……</p>

<div class="wp_codebox"><table><tbody><tr id="p31220"><td class="line_numbers"><pre>248
249
250
251
252
253
254
255
256
257
258
259
260
261
</pre></td><td class="code" id="p312code20"><pre class="javascript" style="font-family:monospace;">    <span style="color: #003366; font-weight: bold;">function</span> drawStar<span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
        gl.<span style="color: #660066;">activeTexture</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">TEXTURE0</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        gl.<span style="color: #660066;">bindTexture</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">TEXTURE_2D</span><span style="color: #339933;">,</span> starTexture<span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        gl.<span style="color: #660066;">uniform1i</span><span style="color: #009900;">(</span>shaderProgram.<span style="color: #660066;">samplerUniform</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        gl.<span style="color: #660066;">bindBuffer</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">ARRAY_BUFFER</span><span style="color: #339933;">,</span> starVertexTextureCoordBuffer<span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        gl.<span style="color: #660066;">vertexAttribPointer</span><span style="color: #009900;">(</span>shaderProgram.<span style="color: #660066;">textureCoordAttribute</span><span style="color: #339933;">,</span> starVertexTextureCoordBuffer.<span style="color: #660066;">itemSize</span><span style="color: #339933;">,</span> gl.<span style="color: #660066;">FLOAT</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        gl.<span style="color: #660066;">bindBuffer</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">ARRAY_BUFFER</span><span style="color: #339933;">,</span> starVertexPositionBuffer<span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        gl.<span style="color: #660066;">vertexAttribPointer</span><span style="color: #009900;">(</span>shaderProgram.<span style="color: #660066;">vertexPositionAttribute</span><span style="color: #339933;">,</span> starVertexPositionBuffer.<span style="color: #660066;">itemSize</span><span style="color: #339933;">,</span> gl.<span style="color: #660066;">FLOAT</span><span style="color: #339933;">,</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
        setMatrixUniforms<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
        gl.<span style="color: #660066;">drawArrays</span><span style="color: #009900;">(</span>gl.<span style="color: #660066;">TRIANGLE_STRIP</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">,</span> starVertexPositionBuffer.<span style="color: #660066;">numItems</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">}</span></pre></td></tr></tbody></table></div>

<p>再往上你一点，你会看到initBuffers函数，也就是用于建立顶点位置数组和纹理坐标数组的；以及用于处理键盘输入的代码handleKeys函数，当你按下Page Up和Page Down键进行缩放，按下方向键进行倾斜；最后是initTexture和handleLoadedTexture函数，其中加载了新的纹理。这些都很简单，所以我不会再对你进行无聊的说教。</p>
<p>让我们直接看一下着色器部分的代码吧！你会看到这节课中的变化。所有与光照有关的代码都被我们移除出了顶点着色器，现在它的代码和第5课完全一致。而片元着色器则发生了一些有趣的变化。</p>

<div class="wp_codebox"><table><tbody><tr id="p31221"><td class="line_numbers"><pre>10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="code" id="p312code21"><pre class="glsl" style="font-family:monospace;">&nbsp;
    <span style="color: #000066; font-weight: bold;">precision</span> <span style="color: #000066; font-weight: bold;">mediump</span> <span style="color: #000066; font-weight: bold;">float</span><span style="color: #000066;">;</span>
&nbsp;
&nbsp;
    <span style="color: #333399; font-weight: bold;">varying</span> <span style="color: #000066; font-weight: bold;">vec2</span> vTextureCoord<span style="color: #000066;">;</span>
&nbsp;
    <span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">sampler2D</span> uSampler<span style="color: #000066;">;</span>
&nbsp;
    <span style="color: #333399; font-weight: bold;">uniform</span> <span style="color: #000066; font-weight: bold;">vec3</span> uColor<span style="color: #000066;">;</span>
&nbsp;
    <span style="color: #000066; font-weight: bold;">void</span> main<span style="color: #000066;">(</span><span style="color: #000066; font-weight: bold;">void</span><span style="color: #000066;">)</span> <span style="color: #000066;">{</span>
        <span style="color: #000066; font-weight: bold;">vec4</span> textureColor <span style="color: #000066;">=</span> <span style="color: #993333; font-weight: bold;">texture2D</span><span style="color: #000066;">(</span>uSampler<span style="color: #000066;">,</span> <span style="color: #000066; font-weight: bold;">vec2</span><span style="color: #000066;">(</span>vTextureCoord<span style="color: #000066;">.</span><span style="color: #006600;">s</span><span style="color: #000066;">,</span> vTextureCoord<span style="color: #000066;">.</span><span style="color: #006600;">t</span><span style="color: #000066;">)</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
        <span style="color: #551111;">gl_FragColor</span> <span style="color: #000066;">=</span> textureColor <span style="color: #000066;">*</span> <span style="color: #000066; font-weight: bold;">vec4</span><span style="color: #000066;">(</span>uColor<span style="color: #000066;">,</span> <span style="color: #0000ff;">1.0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000066;">}</span></pre></td></tr></tbody></table></div>

<p>但不是那么有趣。我们所做的就是提取颜色的uniform变量，它是由Star对象的draw方法传送过来的，然后使用它来为纹理着色。因为纹理是单色的，所以星星会显示出我们需要的合适的颜色。</p>
<p>以上就是本课的全部内容！在这节课中，你学会了如何建立Javascript对象来表示场景中的物体，然后赋予它们方法，允许它们独立地绘制和运动。</p>
<p>下节课中，我们将会展示如何从一个单一文件中载入场景，然后看一看如何操纵相机来穿越场景，配合这些制作出一个小的DOOM游戏！</p>
<div style="clear:both; margin-top:5px; margin-bottom:5px;"></div><div style="float:left"><!-- JiaThis Button BEGIN -->
<div id="ckepop">
	<span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_tools_1"></a>
	<a class="jiathis_button_tools_2"></a>
	<a class="jiathis_button_tools_3"></a>
	<a class="jiathis_button_tools_4"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/jia.js.下载" charset="utf-8"></script>
<!-- JiaThis Button END --></div><div style="clear:both; margin-top:5px; margin-bottom:5px;"></div>											</div><!-- .entry-content -->


					<div class="entry-utility">
						Posted in <a href="http://www.hiwebgl.com/?cat=17" title="查看 WebGL教程 中的全部文章" rel="category">WebGL教程</a>. Bookmark the <a href="http://www.hiwebgl.com/?p=312" title="Permalink to Lesson 9 优化代码结构实现多物体运动" rel="bookmark">permalink</a>.											</div><!-- .entry-utility -->
				</div><!-- #post-## -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://www.hiwebgl.com/?p=294" rel="prev"><span class="meta-nav">←</span> Lesson 8 深度缓存、透明度和混合</a></div>
					<div class="nav-next"><a href="http://www.hiwebgl.com/?p=319" rel="next">Intel公布开源项目River Trail 为Javascript带来并行编程特性 <span class="meta-nav">→</span></a></div>
				</div><!-- #nav-below -->

				

<div id="comments">
		<h3 id="comments-title"><span>1 trackback</span></h3>
	<dl id="trackback_list">
		<dt><a href="http://www.hiwebgl.com/?p=42" rel="external nofollow" class="url">WebGL教程 | WebGL中文教程翻译工程启动！HiWebGL | HiWebGL | 最好的HTML5 WebGL中文资讯站</a></dt>
		<dd><span>2011 年 9 月 23 日 上午 9:44</span></dd>
    </dl>
    <h3 id="comments-title"><span>2 comments</span></h3>
	<ol class="commentlist">
    	
	<li class="comment even thread-even depth-1" id="li-comment-760">
    	<div id="comment-760">
            <div class="comment_meta commentmetadata">
                <span class="avatar"><img alt="" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/ad516503a11cd5ca435acc9bb6523536.png" class="avatar avatar-40 photo" height="40" width="40"></span>
                <span class="comment_author vcard fn">kuroro</span>
                <span class="comment_time">2012 年 4 月 16 日 下午 5:08</span>
            </div>
            <div class="comment_body">
                <p></p><p>第一颗星一直在做直线运动，rotationSpeed为0，this.angle += this.rotationSpeed * effectiveFPMS * elapsedTime一直为0；</p>
<p></p>
                <p class="reply"><a class="comment-reply-link" href="http://www.hiwebgl.com/?p=312&amp;replytocom=760#respond" onclick="return addComment.moveForm(&quot;comment-760&quot;, &quot;760&quot;, &quot;respond&quot;, &quot;312&quot;)">回复</a></p>
            </div>
		</div>
        
        
    
</li>
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-7858">
    	<div id="comment-7858">
            <div class="comment_meta commentmetadata">
                <span class="avatar"><img alt="" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/ad516503a11cd5ca435acc9bb6523536(1).png" class="avatar avatar-40 photo" height="40" width="40"></span>
                <span class="comment_author vcard fn"><a href="http://www.128sf.cn/" rel="external nofollow" class="url">魔域服务器架设</a></span>
                <span class="comment_time">2018 年 2 月 12 日 上午 10:39</span>
            </div>
            <div class="comment_body">
                <p></p><p><a href="http://www.00wy.cn/" rel="nofollow">http://www.00wy.cn</a> 崛起石器时代txt下载</p>
<p></p>
                <p class="reply"><a class="comment-reply-link" href="http://www.hiwebgl.com/?p=312&amp;replytocom=7858#respond" onclick="return addComment.moveForm(&quot;comment-7858&quot;, &quot;7858&quot;, &quot;respond&quot;, &quot;312&quot;)">回复</a></p>
            </div>
		</div>
        
        
    
</li>
    </ol>
        

								<div id="respond">
				<h3 id="reply-title">Post a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.hiwebgl.com/?p=312#respond" style="display:none;">点击这里取消回复。</a></small></h3>
									<form action="http://www.hiwebgl.com/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">电子邮件地址不会被公开。 必填项已用 <span class="required">*</span> 标注</p>							<p class="comment-form-author"><label for="author">姓名</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required="true"></p>
<p class="comment-form-email"><label for="email">电子邮件</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required="true"></p>
<p class="comment-form-url"><label for="url">站点</label><input id="url" name="url" type="text" value="" size="30"></p>
												<p class="comment-form-comment"><label for="comment">评论</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">您可以使用这些 <abbr title="HyperText Markup Language">HTML</abbr> 标签和属性： <code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="发表评论">
							<input type="hidden" name="comment_post_ID" value="312" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="2458d7cc77"></p>					</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->

			</div><!-- #content -->
		</div><!-- #container -->

<div id="sidebar" class="widget-area" role="complementary">
	<ul class="xoxo">
    	<li id="search-2" class="widget-container widget_search"><form id="searchform" method="get" action="http://www.hiwebgl.com/"> 
	<input type="text" name="s" id="s" class="search_term" value="Type in keyword and hit Enter..." onblur="if (this.value == &#39;&#39;) {this.value = &#39;Type in keyword and hit Enter...&#39;;}" onfocus="if (this.value == &#39;Type in keyword and hit Enter...&#39;) {this.value = &#39;&#39;;}">
</form></li><li id="text-4" class="widget-container widget_text"><h3 class="widget-title">加入我们的QQ群</h3>			<div class="textwidget"><b>HiWebGL技术讨论群</b><br>①群群号174563471（已满）<br>②群群号133703893（已满）<br>③群群号196778533（已满）<br>④群群号217873851（已满）<br>⑤群群号225923498（已满）<br>500人群群号219549633<br>欢迎各位程序员和工程师加入！<br><a target="_blank" href="http://qun.qq.com/#jointhegroup/gid/219549633"><img border="0" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/gp.png" alt="点击这里加入此群" title="点击这里加入此群"></a>
<br><br>
<b>HiWebGL产业讨论群</b><br>①群群号176289597（已满）<br>②群群号216936388<br>欢迎关注Web3D发展的从业者与富有理想与激情的创业者朋友加入！<br><a target="_blank" href="http://qun.qq.com/#jointhegroup/gid/216936388"><img border="0" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/gp.png" alt="点击这里加入此群" title="点击这里加入此群"></a></div>
		</li><style type="text/css" media="screen">
#mwrapper-wm_show-3 .mcontainer {height: 300px; overflow: hidden;}
</style>
<li id="wm_show-3" class="widget-container wm_show"><h3 class="widget-title">关注我们的新浪微博！</h3><div class="mwrapper" id="mwrapper-wm_show-3"><div class="head"><img class="headimg" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/89c570d0jw1e8qgp5bmzyj2050050aa8.jpg"><a class="headlink" href="http://weibo.com/2311418064" rel="external nofollow" target="_blank">HiWebGL</a><div class="onekey"><iframe width="63" height="24" frameborder="0" allowtransparency="true" marginwidth="0" marginheight="0" scrolling="no" border="0" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/followbutton.html"></iframe></div></div><a class="scroll up" href="javascript:;"><img src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/transparent.gif"></a><div class="mcontainer"><ul class="microblogs"><li class="tweet">[哆啦A梦吃惊]<div class="rt"><a href="http://weibo.com/crazycomputer" rel="external nofollow" target="_blank">尼奥_</a> : 因写了抢猫粮插件被抓的小喵。<div class="pic rt-pic"><a href="http://ww3.sinaimg.cn/large/6588fb91jw1f8a611qywmj20qo0r743g.jpg" rel="external nofollow" target="_blank"><img src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/6588fb91jw1f8a611qywmj20qo0r743g.jpg"></a></div></div><div class="meta"><a href="http://api.t.sina.com.cn/2311418064/statuses/4025014212843692" rel="external nofollow" target="_blank">9月29日 12:00</a> 来自 <a href="http://weibo.com/2311418064" rel="external nofollow" target="_blank">新浪微博</a></div></li><li class="tweet">转发微博<div class="rt"><a href="http://weibo.com/armcn" rel="external nofollow" target="_blank">ARM中国</a> : 在看颜的时代，如何让一款游戏画面更具高bigger？从8位像素画风到1080P/4K，再到ARM的Enlighten全局光照技术，能够分分钟变化出数十种光照效果，再挑的玩家都给它点赞了，不信你就来看看[围观][围观]<a href="http://t.cn/RcNsHsc" rel="external nofollow" target="_blank">http://t.cn/RcNsHsc</a><div class="pic rt-pic"><a href="http://ww3.sinaimg.cn/large/84217b4fgw1f89g6wubugj20j30q6gr3.jpg" rel="external nofollow" target="_blank"><img src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/84217b4fgw1f89g6wubugj20j30q6gr3.jpg"></a></div></div><div class="meta"><a href="http://api.t.sina.com.cn/2311418064/statuses/4025000392991907" rel="external nofollow" target="_blank">9月29日 11:05</a> 来自 <a href="http://weibo.com/2311418064" rel="external nofollow" target="_blank">新浪微博</a></div></li><li class="tweet">转发微博<div class="rt"><a href="http://weibo.com/baidujs" rel="external nofollow" target="_blank">JS小组</a> : 你知道使用 target='_blank' 也会有安全漏洞么？尤其是在各种 UGC 网站中。不过小编早就玩过了，其实一般倒也不会用在钓鱼上，而是用在各种各样的广告点击中。推荐文章《target='_blank' 安全漏洞示例》地址 <a href="http://t.cn/RchBwVu" rel="external nofollow" target="_blank">http://t.cn/RchBwVu</a>  $w<div class="pic rt-pic"><a href="http://ww2.sinaimg.cn/large/aa9d3df6jw1f7fewekmx8j20g30a1aak.jpg" rel="external nofollow" target="_blank"><img src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/aa9d3df6jw1f7fewekmx8j20g30a1aak.jpg"></a></div></div><div class="meta"><a href="http://api.t.sina.com.cn/2311418064/statuses/4016375595329873" rel="external nofollow" target="_blank">9月5日 15:53</a> 来自 <a href="http://weibo.com/2311418064" rel="external nofollow" target="_blank">新浪微博</a></div></li><li class="tweet">不做游戏，帮转<div class="rt"><a href="http://weibo.com/xdarui" rel="external nofollow" target="_blank">阿里子之</a> : 有做WebVR游戏的公司么，求合作。求圈内大神帮忙转发。@寒冬winter @大城小胖 @w3cplus</div><div class="meta"><a href="http://api.t.sina.com.cn/2311418064/statuses/4015348426770066" rel="external nofollow" target="_blank">9月2日 19:52</a> 来自 <a href="http://weibo.com/2311418064" rel="external nofollow" target="_blank">新浪微博</a></div></li><li class="tweet">阿里云OSS是否支持websockets?有人知道吗？<div class="meta"><a href="http://api.t.sina.com.cn/2311418064/statuses/4006622127044001" rel="external nofollow" target="_blank">8月9日 17:56</a> 来自 <a href="http://weibo.com/2311418064" rel="external nofollow" target="_blank">新浪微博</a></div></li></ul></div><a class="scroll down" href="javascript:;"><img src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/transparent.gif"></a></div></li><li id="recent-comments-2" class="widget-container widget_recent_comments"><h3 class="widget-title">近期评论</h3><ul id="recentcomments"><li class="recentcomments"><a href="http://www.d2film.com/" rel="external nofollow" class="url">企业宣传片制作d2film.com影视视频制作公司QQ30998</a> 发表在《<a href="http://www.hiwebgl.com/?p=42#comment-7984">WebGL中文教程翻译工程启动！</a>》</li><li class="recentcomments"><a href="http://www.128sf.cn/" rel="external nofollow" class="url">魔域服务器架设</a> 发表在《<a href="http://www.hiwebgl.com/?p=312#comment-7858">Lesson 9 优化代码结构实现多物体运动</a>》</li><li class="recentcomments"><a href="http://www.39uc.cn/" rel="external nofollow" class="url">天龙八部师傅m161</a> 发表在《<a href="http://www.hiwebgl.com/?p=70#comment-7857">外媒公布Firefox 6性能测试结果</a>》</li><li class="recentcomments"><a href="http://www.233sf.cn/" rel="external nofollow" class="url">最新奇迹私发网</a> 发表在《<a href="http://www.hiwebgl.com/?p=42#comment-7856">WebGL中文教程翻译工程启动！</a>》</li><li class="recentcomments"><a href="http://www.5aivideo.com/" rel="external nofollow" class="url">婚礼跟拍视频5aivideo.com婚礼摄影MV-QQ73595</a> 发表在《<a href="http://www.hiwebgl.com/?p=42#comment-7829">WebGL中文教程翻译工程启动！</a>》</li></ul></li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">分类目录</h3>		<ul>
	<li class="cat-item cat-item-16"><a href="http://www.hiwebgl.com/?cat=16" title="查看 Demo大赏 下的所有文章">Demo大赏</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://www.hiwebgl.com/?cat=29" title="查看 HTML5新闻 下的所有文章">HTML5新闻</a>
</li>
	<li class="cat-item cat-item-57"><a href="http://www.hiwebgl.com/?cat=57" title="Oak3D中文教程">Oak3D教程</a>
</li>
	<li class="cat-item cat-item-17"><a href="http://www.hiwebgl.com/?cat=17" title="查看 WebGL教程 下的所有文章">WebGL教程</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.hiwebgl.com/?cat=3" title="WebGL新闻">WebGL新闻</a>
</li>
	<li class="cat-item cat-item-10"><a href="http://www.hiwebgl.com/?cat=10" title="查看 博文精选 下的所有文章">博文精选</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://www.hiwebgl.com/?cat=4" title="推荐阅读">推荐</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://www.hiwebgl.com/?cat=1" title="查看 未分类 下的所有文章">未分类</a>
</li>
		</ul>
</li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">文章归档</h3>		<ul>
			<li><a href="http://www.hiwebgl.com/?m=201206" title="2012 年六月">2012 年六月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201205" title="2012 年五月">2012 年五月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201204" title="2012 年四月">2012 年四月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201203" title="2012 年三月">2012 年三月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201202" title="2012 年二月">2012 年二月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201201" title="2012 年一月">2012 年一月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201112" title="2011 年十二月">2011 年十二月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201111" title="2011 年十一月">2011 年十一月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201110" title="2011 年十月">2011 年十月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201109" title="2011 年九月">2011 年九月</a></li>
	<li><a href="http://www.hiwebgl.com/?m=201108" title="2011 年八月">2011 年八月</a></li>
		</ul>
</li>    </ul>
</div><!-- #sidebar .widget-area -->	</div><!-- #main -->
    <div id="footer" role="contentinfo">
    	
    	<div id="colophon">
            <div id="site-info" class="clearfix">
                <div id="generator">Powered by <a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Wordpress</a> and <a href="http://wpcrunchy.com/" title="Free Premium Quality Wordpress Themes">WPCrunchy</a></div>
                <div id="credits">Designed by <a href="http://www.hostreviewgeeks.com/" title="best web hosting" target="_blank">best web hosting</a>. In collaboration with <a href="http://www.hostv.com/" title="VPS Hosting" target="_blank">VPS Hosting</a>, <a href="http://broadwaytickets.co/" title="Broadway Tickets" target="_blank">Broadway Tickets</a>, <a href="http://wpcorner.com/" title="Free Wordpress Themes" target="_blank">Free Wordpress Themes</a>.</div>
            </div>
        </div>
    </div><!-- #footer -->
</div><!-- #wrapper -->

<script type="text/javascript">jQuery(document).ready(function() { if(jQuery("ul.accordion li").length > 2) { jQuery("ul.accordion").accordion(); } });</script><script src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/stat.php" language="JavaScript"></script><script src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=3871765" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/pic.gif"></a><script src="./Lesson 9 优化代码结构实现多物体运动 _ HiWebGL_files/stat.js.下载" defer="defer" async="async"></script>
 </body></html>